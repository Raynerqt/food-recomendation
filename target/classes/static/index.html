<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Recommendation System</title>
    <link rel="stylesheet" href="/style.css">
    <style>
        body { margin: 0; font-family: sans-serif; }
        .app-layout { display: flex; min-height: 100vh; }
        
        /* Sidebar Styling */
        .sidebar {
            width: 320px;
            background-color: #f8f9fa;
            border-right: 1px solid #dee2e6;
            display: flex;
            flex-direction: column;
            padding: 20px;
            height: 100vh;
            position: sticky;
            top: 0;
            overflow-y: auto;
        }

        .history-header {
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 15px;
        }

        .btn-new-chat {
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: background 0.2s;
        }
        .btn-new-chat:hover { background-color: #218838; }

        #history-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        /* Hover effect untuk list history diatur via JS atau CSS ini */
        #history-list li:hover {
            background-color: #e2e6ea !important;
        }

        /* Main Content Styling */
        .main-content {
            flex: 1;
            padding: 40px;
            background-color: #fff;
            overflow-y: auto;
        }
        
        /* Container lama disesuaikan agar pas di main content */
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
    </style>
</head>
<body>

    <div class="app-layout">
        
        <aside class="sidebar">
            <div class="history-header">
                <h2 style="margin-top: 0; font-size: 1.4rem; color: #333;">üìú Journey History</h2>
                <button onclick="resetForm()" class="btn-new-chat">
                    + Start New Session
                </button>
            </div>
            
            <ul id="history-list">
                <li style="text-align: center; color: #999; padding-top: 20px;">
                    Loading history...
                </li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="container">
                <header>
                    <h1>üçé AI-Powered Food Recommendation</h1>
                    <p>Get personalized food recommendations based on your health condition</p>
                </header>

                <div class="card">
                    <form id="recommendationForm">
                        <div class="form-group">
                            <label for="diseaseName">Disease/Health Condition *</label>
                            <input 
                                type="text" 
                                id="diseaseName" 
                                name="diseaseName" 
                                placeholder="e.g., Diabetes, Hypertension, Gastritis"
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="diseaseType">Disease Type</label>
                            <select id="diseaseType" name="diseaseType">
                                <option value="chronic">Chronic (Long-term)</option>
                                <option value="acute">Acute (Short-term)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="severity">Severity (Optional)</label>
                            <select id="severity" name="severity">
                                <option value="">Select severity</option>
                                <option value="mild">Mild</option>
                                <option value="moderate">Moderate</option>
                                <option value="severe">Severe</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="aiProvider">AI Provider</label>
                            <select id="aiProvider" name="aiProvider">
                                <option value="openai">OpenAI (ChatGPT)</option>
                                <option value="claude">Claude AI</option>
                                <option value="gemini">Google Gemini</option>
                            </select>
                        </div>

                        <button type="submit" class="btn-primary" id="submitBtn">
                            Get Recommendations
                        </button>
                    </form>
                </div>

                <div id="loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>Getting recommendations from AI...</p>
                </div>

                <div id="results" class="results" style="display: none;">
                    <div class="card">
                        <h2>üìã Recommendations for <span id="diseaseName-result"></span></h2>
                        <p class="ai-provider">Powered by: <span id="aiProvider-result"></span></p>

                        <div class="recommendations-grid">
                            <div class="recommendation-section foods-to-eat">
                                <h3>‚úÖ Foods You Should Eat</h3>
                                <ul id="foodsToEat-list"></ul>
                            </div>

                            <div class="recommendation-section foods-to-avoid">
                                <h3>‚ùå Foods to Avoid</h3>
                                <ul id="foodsToAvoid-list"></ul>
                            </div>
                        </div>

                        <div class="additional-notes" id="additionalNotes" style="display: none;">
                            <h3>üìù Additional Notes</h3>
                            <p id="notes-content"></p>
                        </div>

                        <div class="raw-response" id="rawResponse" style="display: none;">
                            <h3>üìÑ Full Recommendation</h3>
                            <div id="raw-content"></div>
                        </div>

                        <div id="feedback-section" style="display: none; margin-top: 30px; padding-top: 20px; border-top: 2px dashed #ddd;">
                            <h3>ü©∫ Patient Monitoring (Follow Up)</h3>
                            <p>How is your condition now? (e.g., Recovered, Worsening, No Change)</p>
                            
                            <div class="form-group">
                                <textarea id="user-condition" rows="3" 
                                          style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;" 
                                          placeholder="Describe your current condition here..."></textarea>
                            </div>

                            <button onclick="submitFeedback()" class="btn-primary" style="background-color: #e67e22; border-color: #e67e22;">
                                Report Condition to AI
                            </button>

                            <div id="final-advice" style="margin-top: 20px;"></div>
                        </div>

                        <button class="btn-secondary" onclick="resetForm()">
                            Make Another Query
                        </button>
                    </div>
                </div>

                <div id="error" class="error" style="display: none;">
                    <div class="card error-card">
                        <h3>‚ö†Ô∏è Error</h3>
                        <p id="error-message"></p>
                        <button class="btn-secondary" onclick="resetForm()">Try Again</button>
                    </div>
                </div>
                
                <footer>
                    <p>Built with ‚ù§Ô∏è using Spring Boot & AI APIs | OOP Project 2024</p>
                </footer>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>